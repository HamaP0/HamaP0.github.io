---
layout: post
title: "A07:2021 - Identification and Authentication Failures (식별 및 인증 실패) 분석 보고서"
date: 2025-08-31 17:00:00 +0900
categories: Projects OWASP-Top-10
---
---

### **프로젝트 7. A07:2021 - Identification and Authentication Failures (식별 및 인증 실패) 분석 보고서**

#### **1. 취약점 개요**

우리 집 현관문에 달린 디지털 도어락을 생각해 볼 수 있습니다. 정확한 비밀번호를 눌러야만 문이 열리는 것이 '인증'의 기본입니다. 하지만 만약 이 도어락이 "비밀번호를 수백 번 틀려도 아무런 경고 없이 계속 시도할 수 있고", "로그인 성공 후 받은 열쇠(세션)를 너무나 쉽게 복제할 수 있다면" 어떨까요? '식별 및 인증 실패'는 바로 이처럼 **"당신이 정말 주인인지 확인하고, 그 인증 상태를 안전하게 유지하는" 모든 과정에 허점이 발생하는 문제**를 말합니다.

단순히 로그인이 뚫리는 것뿐만 아니라, 약한 암호 정책, 허술한 계정 복구 절차, 예측 가능한 세션 ID 발급 등 신원 확인 및 유지와 관련된 모든 취약점이 여기에 포함됩니다. 이 보고서에서는 DVWA 환경의 여러 기능에 흩어져 있는 인증 관련 취약점들을 집중적으로 분석해 보았습니다.

---

#### **2. 시나리오 분석 및 재현**

**Part 1. 열릴 때까지 두드리기: 무차별 대입 공격 (Brute-Force Attack)**

*   **가설 설정:**
 가장 기본적인 관문은 역시 로그인 창. 만약 도어락이 "비밀번호 5번 틀리면 1분간 정지!" 같은 규칙 없이 무한한 도전을 허용한다면, 컴퓨터의 힘을 빌려 상상할 수 있는 모든 비밀번호를 자동으로 눌러보는 공격에 언젠가는 뚫리지 않을까?

*   **분석 및 검증:**
    사용자 신원을 확인하는 가장 기본적인 관문인 로그인 과정의 취약점을 분석했습니다. **`A04: 안전하지 않은 설계` 보고서에서 분석했듯이**, 이 로그인 기능에는 '계정 잠금 정책'이라는 핵심적인 방어 기능이 설계 단계에서부터 누락되어 있었습니다.

    '인증'의 관점에서 이 결함을 바라보면, 이는 공격자가 비밀번호를 무한히 추측할 수 있는 환경을 제공하여 사용자의 신원(Identity)을 탈취할 수 있는 직접적인 원인이 됩니다. Burp Suite의 `Intruder` 툴을 이용해 사전 공격(Dictionary Attack)을 수행한 결과, 다른 모든 실패 응답과 확연히 다른 `Length`(5072) 값을 가진 성공 응답을 특정할 수 있었습니다. 이를 통해 `admin` 계정의 암호가 `password`임을 알아냄으로써, 이 인증 메커니즘이 무차별 대입 공격에 완전히 무방비 상태임을 증명했습니다.

   ![Length](/assets/images/A04_P1-1.png)

*   **위험성 분석:**
    계정 잠금 정책의 부재는 가장 기본적인 인증 보안의 실패입니다. 공격자는 시간만 충분하다면 거의 모든 계정을 탈취할 수 있게 되며, 이는 개인정보 유출을 넘어 시스템 전체의 관리자 권한 탈취로 이어질 수 있는 심각한 위협입니다.

**Part 2. 복제된 열쇠: 취약한 세션 관리**

*   **가설 설정:**
    성공적인 인증 후 발급되는 '세션 ID'가 만약 예측 가능한 규칙을 가지고 있다면, 공격자는 다른 사용자의 세션 ID를 추측하여 인증 절차를 건너뛰고 계정을 탈취(세션 하이재킹)할 수 있을 것이다.

*   **분석 및 검증:**
    로그인 성공 '이후', 사용자의 인증 상태를 안전하게 유지하는 세션 관리의 취약점을 분석했습니다. **`A02: 암호화 실패` 보고서에서 확인했듯이**, 이 시스템의 세션 ID는 암호학적으로 안전한 난수가 아닌, 1, 2, 3... 으로 순차적으로 증가하는 단순 정수로 생성되는 근본적인 문제를 가지고 있습니다.

    '인증 유지'의 관점에서 이 문제를 보면, 공격자는 현재 접속해 있는 다른 사용자의 세션 ID를 매우 쉽게 추측할 수 있게 됩니다. 이는 성공적으로 인증을 마친 사용자의 '출입증(세션 쿠키)'을 위조하여 그 사람 행세를 하는 '세션 하이재킹' 공격으로 이어집니다. 결국, 아무리 강력한 비밀번호로 인증을 통과했더라도, 그 인증 상태 자체를 도둑맞아 인증 시스템 전체가 무력화될 수 있습니다.

   ![1](/assets/images/A02_P1-1.png)
   ![2](/assets/images/A02_P1-1.png)
   ![3](/assets/images/A02_P1-1.png)

*   **위험성 분석:**
    예측 가능한 세션 ID는 공격자가 비밀번호를 몰라도 사용자의 계정을 탈취할 수 있게 만드는 치명적인 취약점입니다. 공격자는 탈취한 세션으로 사용자의 모든 활동을 수행할 수 있으며, 사용자는 자신의 계정이 탈취되었다는 사실조차 인지하기 어렵습니다.

**Part 3. 허술한 뒷문: 안전하지 않은 계정 복구**

*   **가설 설정:**
    비밀번호를 잊었을 때 이용하는 '계정 복구' 기능이 만약 사회 공학적으로 유추하기 쉬운 정보에 의존한다면, 공격자는 이를 우회하여 합법적인 절차처럼 계정의 소유권을 이전받을 수 있을 것이다.

*   **분석:**
     DVWA에는 해당 기능이 없지만, 실제 서비스에서 가장 심각한 인증 실패는 종종 '계정 복구' 과정에서 발생합니다. 아래는 인터넷에서 쉽게 찾아볼 수 있는, 사회 공학적 공격에 취약한 본인 확인 질문의 예시입니다.

   ![취약한 인증](/assets/images/A07_P3-1.png)

    이처럼 '어머니의 성함', '졸업한 초등학교 이름' 등은 SNS나 주변인 탐문 등 약간의 노력만으로도 공격자가 충분히 알아낼 수 있는 정보입니다. 아래의 흐름도처럼, 이러한 정보에만 의존하는 복구 절차는 인증 시스템의 치명적인 뒷문이 됩니다.

   ![안전하지 않은 흐름도](/assets/images/A07_P3-3.png)


*   **위험성 분석:**
     안전하지 않은 계정 복구는 MFA와 같은 강력한 인증 체계를 모두 우회하고 계정을 탈취할 수 있는 심각한 위협입니다. 이를 해결하기 위해서는 반드시 아래와 같이 이메일, SMS 등 사용자가 실제로 '소유'하고 있는 다른 채널을 통한 2차 인증(Out-of-Band Authentication)을 거쳐야만 합니다.

   ![2차 인증](/assets/images/A07_P3-2.png)
   ![안전한 흐름도](/assets/images/A04_P3-4.png)

---

#### **3. 근본 원인 및 해결 방안: 심층 방어 기반의 인증 체계 구축**

*   **원인:** 단일 실패 지점 (Single Point of Failure)
    위 세 가지 문제의 공통적인 원인은, 인증 과정을 여러 겹으로 보호하는 심층 방어 전략 없이 단 하나의 방어선(비밀번호)에만 의존했기 때문입니다. 비밀번호 추측을 막는 장치도, 인증 상태를 지키는 장치도, 비상시를 위한 복구 절차도 모두 허술했습니다.

*   **해결 방안:**
    안전한 인증 체계를 구축하기 위해서는 여러 방어 계층을 겹겹이 쌓는 것이 필수적입니다. **NIST(미국 국립표준기술연구소)의 Digital Identity Guidelines (SP 800-63B)** 와 같은 국제 표준을 준수하여 다음과 같은 다중 방어 전략을 구현해야 합니다.

    1.  **강력한 패스워드 정책:** '최소 8자, 특수문자 포함' 같은 낡은 규칙을 넘어, **① 최소 길이를 12자 이상으로 길게 설정**하고(컴퓨터는 `a!b@c#12`보다 `i_like_my_cat_rang`를 더 어려워합니다), **② 알려진 유출 비밀번호 목록과 비교**하여 쉬운 패스워드를 금지하며, **③ 복잡성을 강요하기보다 길이를 권장**하는 현대적인 정책을 도입해야 합니다.

    2.  **무차별 대입 공격 방어:** **① 계정 잠금 정책**(예: 5회 실패 시 10분 잠금)과 **② IP 기반 시도 횟수 제한(Rate Limiting)**을 반드시 구현하여 자동화된 공격을 무력화해야 합니다.

    3.  **다중 인증 (MFA) 도입:** 비밀번호가 유출되더라도 계정을 보호할 수 있는 가장 강력한 안전장치입니다. OTP 앱, 생체 인식 등 사용자가 **'아는 것(비밀번호)'** 외에 **'가지는 것(스마트폰)'**이나 **'고유한 특성(지문)'**을 추가로 인증해야 합니다.

    4.  **안전한 세션 관리:** 암호학적으로 안전한 난수 생성기(CSPRNG)를 통해 예측 불가능한 세션 ID를 생성하고, 모든 세션 쿠키에 `HttpOnly`, `Secure`, `SameSite=Strict` 속성을 부여하여 세션 탈취 공격을 원천적으로 방어해야 합니다.

---