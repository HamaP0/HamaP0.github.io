---
layout: post
title: "A02:2021 - Cryptographic Failures (암호화 실패) 분석 보고서"
date: 2025-08-26 17:00:00 +0900
categories: Projects OWASP-Top-10
---
---

### **프로젝트 2. A02:2021 - Cryptographic Failures (암호화 실패) 분석 보고서**

### **1. 취약점 개요**

암호화는 비밀번호나 개인 정보와 같이 중요한 데이터를 보호하기 위해, 그 내용을 쉽게 알 수 없도록 변환하는 기술입니다. **`암호화 실패`**는 이러한 기술을 적용하지 않거나, 보안 수준이 낮은 방식을 사용하여 중요 정보가 노출되는 모든 상황을 의미합니다. 

본 보고서에서는 DVWA 테스트 환경에서 흔히 발견되는 세 가지 암호화 문제점, 즉, 예측 가능한 인증 토큰, 암호화되지 않은 정보 전송, 그리고 취약한 암호화 방식에 따른 데이터 저장 문제를 분석하고, 현대 보안 기준에 부합하는 데이터 보호 방법을 모색합니다.

---

### **2. 시나리오 분석 및 재현**

**Part 1. 예측 가능한 토큰: 취약한 세션 ID 생성**

*   **가설 설정:**
로그인한 사용자를 구별하기 위해 서버는 **세션 ID**라는 이름표를 나눠준다. 만약 이 이름표가 컴퓨터가 무작위로 만든, 추측하기 아주 어려운 숫자가 아니라 1, 2, 3처럼 규칙적인 패턴으로 만들어진다면, 공격자가 다른 사람의 이름표 번호를 쉽게 추측해서 그 사람인 척 위장할 수 있을 것이다.

*   **공격 검증:**
Burp Suite라는 도구로 `Weak Session IDs` 페이지에 똑같은 요청을 여러 번 보내봤습니다. 그랬더니 서버가 제게 나눠주는 dvwaSession이라는 이름표 값이 `1, 2, 3...` 순서로 뻔하게 증가하는 것을 확인할 수 있었습니다.

   ![1]({{ "/assets/images/A02_P1-1.png" | relative_url }})
   ![2]({{ "/assets/images/A02_P1-2.png" | relative_url }})
   ![3]({{ "/assets/images/A02_P1-3.png" | relative_url }})

*   **위험성 분석:**
공격자는 이 간단한 규칙을 이용해서 지금 접속해 있는 다른 사용자의 이름표 번호를 매우 쉽게 알아낼 수 있습니다. 그리고 그 이름표를 이용해 다른 사람의 계정을 가로채는 **세션 하이재킹** 공격을 할 수 있게 됩니다.

**Part 2. 평문 전송: 암호화되지 않은 민감 정보 노출**

*   **가설 설정:**
웹사이트 주소가 `http://`로 시작한다면, 우리가 보내는 모든 정보는 암호화되지 않은 채로 서버까지 전달된다. 그렇다면 로그인할 때 입력하는 아이디와 비밀번호도 중간에 누군가 마음만 먹으면 그대로 엿볼 수 있을 것이다.

*   **공격 검증:**
Burp Suite로 DVWA 로그인 요청을 중간에서 가로채서 내용을 들여다봤습니다. 역시나, 비밀번호를 입력하는 password 칸의 값이 암호화되지 않은 날것 그대로의 글자`평문` 상태로 전송되는 것을 확인했습니다.

   ![password]({{ "/assets/images/A02_P2-1.png" | relative_url }})
   ![letmein]({{ "/assets/images/A02_P2-2.png" | relative_url }})

*   **위험성 분석:**
이렇게 암호화되지 않은 통신은 중간자 공격`MITM`에 매우 위험합니다. 같은 와이파이(Wi-Fi)를 쓰는 공격자가 통신 내용을 엿듣는 것만으로 아이디와 비밀번호를 간단하게 훔쳐갈 수 있습니다. 특히 보안이 취약한 공용 와이파이를 사용할 때 아주 치명적일 수 있습니다.

**Part 3. 취약한 데이터 저장: 오래된 해시 알고리즘 사용**

*   **가설 설정:**
데이터베이스에는 보통 비밀번호를 직접 저장하지 않고, 암호처럼 복잡하게 바꾼 값`해시`을 저장한다. 만약 이때 사용하는 암호화 방식이 너무 낡고 약해서 이제는 쓰면 안 되는 방식이라면, 해커가 그 암호를 너무 쉽게 풀어버릴 수 있을 것이다.

*   **공격 검증:**
SQL Injection 공격으로 데이터베이스의 사용자 정보`users 테이블`를 빼내어 비밀번호가 저장된 부분을 확인했습니다. 저장된 암호`5f4dcc3b5aa7...`의 형태를 보니, 현재는 보안 문제 때문에 절대 사용하면 안 되는 **MD5**라는 낡은 해시 알고리즘으로 만들어진 값이었습니다.

   ![' UNION SELECT user, password FROM users#]({{ "/assets/images/A02_P3-1.png" | relative_url }})

*   **위험성 분석:**
MD5 방식은 이제 너무 약해서 **레인보우 테이블**이라는, 미리 만들어 놓은 거대한 해시-비밀번호 정답표를 이용하면 단 몇 초 만에 원래 비밀번호를 찾아낼 수 있습니다. 만약 데이터베이스가 통째로 유출된다면, MD5로 저장된 비밀번호는 사실상 그냥 비밀번호를 그대로 저장한 것과 별 차이가 없을 정도로 위험합니다.
    
---

#### **3. 근본 원인 및 해결 방안**

*   **원인: 최신 보안 규칙을 지키지 않은 것**

위에 제시된 세 가지 주요 문제의 원인은 웹사이트 개발 시 최신 보안 규칙을 제대로 지키지 않은 결과입니다. 예측 불가능해야 할 인증 토큰을 순차적으로 생성하고, 개인 정보를 암호화하지 않은 채로 전송하며, 취약점이 발견된 지 오래된 암호화 방식을 사용한 것이 문제의 핵심입니다. 

*   **해결 방안: 데이터 처리 단계별 보안 강화**

암호화 문제를 막기 위해서는 데이터를 처리하는 각 단계별로 보안을 강화해야 하며, 특히 데이터 생성, 전송, 저장 시 아래 제시된 보안 규칙을 철저히 준수해야 합니다.

   ![보안 규칙]({{ "/assets/images/A02_table.png" | relative_url }})

1.  **데이터 전송 보안:**
*   웹사이트의 모든 통신은 http가 아닌 https를 사용해야 합니다. https는 'TLS'라는 기술로 우리가 보내는 모든 정보를 암호화해서, 중간에 누가 훔쳐보더라도 무슨 내용인지 알 수 없게 만들어 줍니다.

2.  **데이터 저장 보안:**
*   비밀번호는 반드시 Bcrypt나 Argon2 같은 최신 기술로 암호화해서 저장해야 합니다.
*   이 기술들은 그냥 암호화만 하는 게 아니라, 비밀번호에 소금`Salt`을 치듯 사용자마다 고유한 값을 섞고, 수천 번 이상 계산을 반복해서 키 스트레칭`Key Stretching` 암호를 훨씬 더 풀기 어렵게 만듭니다. 덕분에 해커의 공격을 효과적으로 막을 수 있습니다.

3.  **보안 토큰 생성:**
*   세션 ID를 포함한 모든 보안 토큰은 반드시 예측이 불가능하도록, 암호학적으로 안전한 의사 난수 생성기`CSPRNG`를 통해 생성되어야 합니다.


<hr class="short-rule">
