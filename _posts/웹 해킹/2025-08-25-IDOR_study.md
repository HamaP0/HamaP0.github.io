---
layout: post
title: "IDOR 공부"
date: 2025-08-25 17:00:00 +0900
categories: [웹 해킹]
---

### 1. 개요

IDOR는 서버가 요청된 객체에 접근하려는 사용자의 권한을 확인하지 않아 발생하는 접근 통제 취약점이다.

'인가 실패'의 대표적인 사례로 사용자가 직접 제어할 수 있는 파라미터(주로 ID 값)를 조작하여 허가되지 않은 다른 사용자의 데이터에 접근하는 공격이다.

---

### 2. 공격 시나리오

1.  공격자는 정상적으로 로그인하여 자신의 프로필 페이지에 접근한다. 이때 브라우저의 URL은 다음과 같다.
    `https://example.com/profile?user_id=101`
2.  공격자는 `user_id` 파라미터가 서버의 데이터베이스에서 사용자를 식별하는 키 값이라고 추측한다.
3.  공격자는 이 `user_id` 값을 다른 사용자의 ID로 추정되는 값(예: `102`)으로 변경하여 서버에 다시 요청을 보낸다.
    `https://example.com/profile?user_id=102`
4.  만약 서버 측에서 이 요청을 보낸 사용자가 정말로 `user_id=102`의 주인인지 확인하는 인가(Authorization) 절차를 누락했다면 공격자는 다른 사용자의 프로필 정보를 그대로 볼 수 있게 된다.

---

### 3. Burp Suite를 이용한 실습

Burp Suite의 Repeater 기능을 이용하면 이 공격을 쉽게 시뮬레이션하고 서버의 반응을 확인할 수 있다.

1.  자신의 프로필을 조회하는 정상적인 요청을 Burp Suite로 가로채 Repeater로 보낸다.
2.  Request 패널에서 `user_id=101` 부분을 `user_id=102`로 수정한다.
3.  `Send` 버튼을 눌러 변조된 요청을 보낸다.
4.  Response 패널에 다른 사용자의 개인정보가 포함된 HTML이 반환된다면 IDOR 취약점이 존재함을 의미한다.
   ![IDOR](/assets/images/IDOR_1.png)

---

### 4. 방어 방안

IDOR 공격을 막는 가장 근본적인 방법은 서버 측에서 모든 요청에 대해 **소유권 검증(Ownership Verification)**을 수행하는 것이다.

*   **세션 기반 검증:** 사용자가 `user_id=102`의 정보를 요청했을 때 파라미터로 넘어온 `102`를 기준으로 데이터를 조회하는 것이 아니라 서버에 안전하게 저장된 **세션**에서 현재 로그인한 사용자의 ID(예: `101`)를 가져와야 한다.
*   요청된 리소스의 소유자 ID와 세션의 사용자 ID가 일치하는 경우에만 요청을 허용하고 일치하지 않으면 접근 거부(403 Forbidden) 응답을 반환해야 한다.

<hr class="short-rule">




### 시각 자료(이미지) 제작을 위한 스크립트

#### **IDOR 공격 시뮬레이션 이미지 제작**

1.  Burp Suite Repeater에서 자신의 정보를 조회하는 `GET /api/users/123` 요청을 준비한다.
2.  요청을 보내 정상적으로 자신의 정보가 응답으로 오는지 확인한다.
3.  요청 URI의 `123`을 `124`로 변경하고 다시 요청을 보낸다.
4.  응답 패널에 다른 사용자의 정보가 출력된 상태에서, 요청 패널의 변경된 `userId`와 응답 패널의 타인 정보에 각각 하이라이트를 적용하여 스크린샷을 찍고 저장한다.