---
layout: post
title: "PHP 공부"
date: 2025-09-09 17:00:00 +0900
categories: Study 웹 기술
---

### 1. PHP 개요

PHP는 서버 측에서 실행되는 스크립트 언어이다. APM 스택에서 'P'를 담당하며 Apache와 같은 웹 서버 위에서 동작한다.

주요 역할은 사용자의 요청을 받아 데이터베이스와 통신하고 그 결과를 처리하여 동적인 HTML 웹 페이지를 생성하는 것이다. DVWA를 포함한 많은 웹 애플리케이션이 PHP로 만들어졌다.

---

### 2. 주요 보안 관련 설정 (php.ini)

`php.ini` 파일은 PHP의 동작을 제어하는 핵심 설정 파일이다. 이 파일의 설정값에 따라 서버의 보안 수준이 크게 달라질 수 있다.

*   **`allow_url_include`**: `include`, `require` 같은 함수가 원격지 파일을 URL로 가져올 수 있도록 허용하는 설정이다. `On`으로 설정되면 원격 파일 포함(RFI) 공격에 매우 취약해지므로 반드시 `Off`로 설정해야 한다.

*   **`expose_php`**: HTTP 응답 헤더에 PHP 버전 정보를 노출할지 결정한다. `On`으로 설정되면 공격자에게 시스템의 구체적인 버전 정보를 알려주게 되므로 `Off`로 설정하는 것이 안전하다.

*   **`display_errors`**: PHP 코드 실행 중 오류가 발생했을 때 그 내용을 웹 페이지에 직접 표시할지 결정한다. 개발 환경에서는 디버깅을 위해 `On`으로 설정하기도 하지만 운영 서버에서는 파일 경로, 데이터베이스 정보 등 민감한 정보가 노출될 수 있어 반드시 `Off`로 설정해야 한다.

---

### 3. 정보 노출: phpinfo()

`phpinfo()`는 PHP의 현재 설정 상태와 모듈 정보 등 모든 것을 상세하게 보여주는 함수이다. 개발 과정에서는 유용하지만 이 파일이 외부에 노출되면 서버의 거의 모든 내부 설계도를 공격자에게 넘겨주는 것과 같다.

[여기에 phpinfo() 페이지 스크린샷 삽입]

실제 운영 환경에서는 `phpinfo()`를 포함한 파일은 반드시 제거해야 한다.

---

### 4. 취약점을 유발하는 코드 패턴

#### **사용자 입력 값의 직접 사용**
사용자가 제어할 수 있는 `$_GET`, `$_POST` 같은 변수의 값을 아무런 검증 없이 코드에 그대로 사용하는 것은 매우 위험하다.

```php
// Path Traversal 취약점을 유발하는 코드
$file = $_GET['page'];
include($file);
```
위 코드는 사용자가 `?page=../../../../etc/passwd`와 같은 값을 입력하는 것을 막지 못해 시스템 파일을 유출시킬 수 있다.

#### **보안에 취약한 함수 사용**
오래되거나 안전하지 않은 함수를 사용하는 것도 주요 취약점의 원인이 된다.
*   **패스워드 해싱**: `md5()`, `sha1()` 함수는 현재 패스워드 저장용으로 사용하기에 안전하지 않다. `password_hash()`와 같은 최신 함수를 사용해야 한다.
*   **명령어 실행**: `shell_exec()`, `system()` 함수는 사용자 입력을 받아 실행할 경우 명령어 인젝션 공격으로 이어질 수 있다.

<hr class="short-rule">





### 시각 자료(이미지) 제작을 위한 스크립트

#### **phpinfo() 페이지 스크린샷 제작**

1.  (준비) DVWA 서버의 `/var/www/html` 디렉터리에 `info.php` 라는 파일을 새로 만듭니다.
2.  `info.php` 파일 안에 `<?php phpinfo(); ?>` 라는 내용만 입력하고 저장합니다.
3.  웹 브라우저에서 `http://192.9.200.11/info.php` 주소로 접속합니다.
4.  PHP 로고와 함께 서버의 상세 정보가 담긴 긴 페이지가 나타납니다. 이 화면을 스크린샷으로 찍습니다.
5.  이미지 편집 프로그램을 사용하여 스크린샷을 엽니다.
6.  공격자에게 유용할 만한 민감 정보들에 하이라이트를 적용합니다.
    *   **PHP 버전 정보** (예: `PHP Version 8.x.x`)
    *   **서버의 Document Root 경로** (예: `_SERVER["DOCUMENT_ROOT"]` 값)
    *   **Apache 모듈 정보** (예: `Loaded Modules` 섹션)
7.  하이라이트가 적용된 이미지를 저장하여 게시글에 삽입합니다.