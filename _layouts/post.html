<!-- _layouts/post.html -->
---
layout: default
---
<article class="post">
  <header class="post-header">
    <h1 class="post-title">{{ page.title | escape }}</h1>
    <p class="post-meta">
      작성일: {{ page.date | date: "%Y년 %m월 %d일" }}
      {% if page.categories.size > 0 %}
        • 카테고리: {{ page.categories | join: ', ' }}
      {% endif %}
    </p>
  </header>

  <div class="post-content">
    {{ content }}
  </div>
</article>

<hr>
<nav class="post-nav" aria-label="이전·다음 글">
  {% assign posts = site.categories[ page.primary_category | default: page.categories | first ] | default: [] | sort: 'date' %}
  {% assign idx = posts | map: 'url' | index_of: page.url %}
  {% if idx == -1 %}
    {% assign idx = posts | index_of: page %}
  {% endif %}

  {% if idx > 0 %}
    {% assign prev = posts[idx | minus: 1] %}
    <a class="prev" href="{{ prev.url | relative_url }}">
      « 이전 글: {{ prev.title | escape }}
    </a>
  {% endif %}

  {% assign last = posts.size | minus: 1 %}
  {% if idx < last %}
    {% assign next = posts[idx | plus: 1] %}
    <a class="next" href="{{ next.url | relative_url }}">
      다음 글: {{ next.title | escape }} »
    </a>
  {% endif %}

  {%- comment -%}
    // 카테고리가 없거나, posts 배열에 이 글만 있을 때
    // page.previous/page.next 로 대체
  {%- endcomment -%}
  {%
    comment
  %}
  {% if posts.size <= 1 %}
    {% if page.previous %}
      <a class="prev" href="{{ page.previous.url | relative_url }}">
        « 이전 글: {{ page.previous.title | escape }}
      </a>
    {% endif %}
    {% if page.next %}
      <a class="next" href="{{ page.next.url | relative_url }}">
        다음 글: {{ page.next.title | escape }} »
      </a>
    {% endif %}
  {% endif %}
  {%
    endcomment
  %}
</nav>
