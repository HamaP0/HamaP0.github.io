---
layout: default 
---

<article class="post">
  <header class="post-header">
    <h1 class="post-title">{{ page.title }}</h1>
    <p class="post-meta">
      작성일: {{ page.date | date: "%Y년 %m월 %d일" }}
      {% if page.categories.size > 0 %}
        • 카테고리: {{ page.categories | join: ', ' }}
      {% endif %}
    </p>
  </header>

  <div class="post-content">
    {{ content }}
  </div>

  <!-- ====================================================== -->
  <!-- forloop.index0를 사용한, 올바르고 안정적인 최종 내비게이션 -->
  <!-- ====================================================== -->
  {% assign category_name = page.categories | first %}
  {% if category_name %}
    {% comment %} 1. 글을 날짜순(오래된 순)으로 명확하게 정렬합니다. {% endcomment %}
    {% assign sorted_posts = site.categories[category_name] | sort: 'date' %}
    {% assign post_count = sorted_posts | size %}

    {% if post_count > 1 %}
      <nav class="post-nav">
        {% comment %} 2. 정렬된 목록을 반복하며 현재 글의 인덱스를 찾고, 즉시 링크를 생성합니다. {% endcomment %}
        {% for post in sorted_posts %}
          {% if post.url == page.url %}

            {% comment %} 현재 글의 인덱스(index0)가 0보다 크면, 이전 글이 존재합니다. {% endcomment %}
            {% if forloop.index0 > 0 %}
              {% assign prev_post_index = forloop.index0 | minus: 1 %}
              {% assign prev_post = sorted_posts[prev_post_index] %}
              <a class="prev" href="{{ prev_post.url | relative_url }}">« 이전 글: {{ prev_post.title }}</a>
            {% endif %}

            {% comment %} 현재 글의 인덱스가 (총 개수 - 1)보다 작으면, 다음 글이 존재합니다. {% endcomment %}
            {% if forloop.index0 < post_count | minus: 1 %}
              {% assign next_post_index = forloop.index0 | plus: 1 %}
              {% assign next_post = sorted_posts[next_post_index] %}
              <a class="next" href="{{ next_post.url | relative_url }}">다음 글: {{ next_post.title }} »</a>
            {% endif %}
            
          {% endif %}
        {% endfor %}
      </nav>
    {% endif %}
  {% endif %}
</article>
