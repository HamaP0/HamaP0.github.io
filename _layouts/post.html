---
layout: default
---
<!-- _layouts/post.html -->
<article class="post">
  <header class="post-header">
    <h1 class="post-title">{{ page.title | escape }}</h1>
    <p class="post-meta">
      작성일: {{ page.date | date: "%Y년 %m월 %d일" }}
      {% if page.categories.size > 0 %}
        • 카테고리: {{ page.categories | join: ', ' }}
      {% endif %}
    </p>
  </header>

  <div class="post-content">
    {{ content }}
  </div>

  {% comment %} ====================================================== {% endcomment %}
  {% comment %}    이전/다음 글 내비게이션 (오류 방지 최종 로직)        {% endcomment %}
  {% comment %} ====================================================== {% endcomment %}

  {%- assign category_to_navigate = page.primary_category | default: page.categories.first -%}

  {%- if category_to_navigate -%}
    {%- comment -%}
      [오류 수정] site.categories에서 글 목록을 가져옵니다.
    {%- endcomment -%}
    {%- assign posts_of_category = site.categories[category_to_navigate] -%}

    {%- comment -%}
      [오류 수정] 가져온 글 목록이 실제로 존재하는 경우에만 아래 로직을 실행합니다.
      이것이 'Cannot sort a null object' 오류를 근본적으로 방지합니다.
    {%- endcomment -%}
    {%- if posts_of_category -%}
      {%- assign posts_in_category = posts_of_category | sort: 'date' -%}

      {%- for post_item in posts_in_category -%}
        {%- if post_item.url == page.url -%}
          {%- assign current_post_index = forloop.index0 -%}
          {%- break -%}
        {%- endif -%}
      {%- endfor -%}

      {%- if current_post_index and posts_in_category.size > 1 -%}
        <hr>
        <nav class="post-nav" aria-label="이전·다음 글">

          {%- if current_post_index > 0 -%}
            {%- assign prev_post_index = current_post_index | minus: 1 -%}
            {%- assign previous_post = posts_in_category[prev_post_index] -%}
            <a class="prev" href="{{ previous_post.url | relative_url }}">« 이전 글: {{ previous_post.title | escape }}</a>
          {%- endif -%}

          {%- if current_post_index < posts_in_category.size | minus: 1 -%}
            {%- assign next_post_index = current_post_index | plus: 1 -%}
            {%- assign next_post = posts_in_category[next_post_index] -%}
            <a class="next" href="{{ next_post.url | relative_url }}">다음 글: {{ next_post.title | escape }} »</a>
          {%- endif -%}

        </nav>
      {%- endif -%}
    {%- endif -%}
  {%- endif -%}
</article>
