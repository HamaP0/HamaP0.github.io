<!-- _layouts/post.html -->
---
---
<article class="post">
  <header class="post-header">
    <h1 class="post-title">{{ page.title | escape }}</h1>
    <p class="post-meta">
      작성일: {{ page.date | date: "%Y년 %m월 %d일" }}
      {% if page.categories.size > 0 %}
        • 카테고리: {{ page.categories | join: ', ' }}
      {% endif %}
    </p>
  </header>

  <div class="post-content">
    {{ content }}
  </div>

  {% comment %} ====================================================== {% endcomment %}
  {% comment %}   가장 효율적이고 안정적인 카테고리별 이전/다음 글 내비게이션     {% endcomment %}
  {% comment %} ====================================================== {% endcomment %}
  {% assign category = page.categories | first %}
  {% if category %}
    {% comment %} 1. 현재 카테고리의 모든 글을 날짜 오름차순(오래된 순)으로 정렬합니다. {% endcomment %}
    {% assign posts_in_category = site.categories[category] | sort: 'date' %}

    {% if posts_in_category.size > 1 %}
      {% comment %} 2. for 루프 없이 현재 글의 인덱스를 직접 찾습니다. (가장 효율적인 방식) {% endcomment %}
      {% assign current_post_index = posts_in_category | map: 'url' | index_of: page.url %}
      
      <hr>
      <nav class="post-nav">
        {% comment %} 3. 이전 글(더 과거의 글)이 있는지 확인하고 링크를 생성합니다. {% endcomment %}
        {% if current_post_index > 0 %}
          {% assign prev_post_index = current_post_index | minus: 1 %}
          {% assign prev_post = posts_in_category[prev_post_index] %}
          <a class="prev" href="{{ prev_post.url | relative_url }}">« 이전 글: {{ prev_post.title | escape }}</a>
        {% endif %}

        {% comment %} 4. 다음 글(더 최신의 글)이 있는지 확인하고 링크를 생성합니다. {% endcomment %}
        {% if current_post_index < posts_in_category.size | minus: 1 %}
          {% assign next_post_index = current_post_index | plus: 1 %}
          {% assign next_post = posts_in_category[next_post_index] %}
          <a class="next" href="{{ next_post.url | relative_url }}">다음 글: {{ next_post.title | escape }} »</a>
        {% endif %}
      </nav>
    {% endif %}
  {% endif %}
</article>
