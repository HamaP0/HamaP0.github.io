<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title | default: site.title }}</title>

  <!-- 모바일 브라우저 UI 색상 -->
  <meta name="theme-color" content="#E8EAED" media="(prefers-color-scheme: light)">
  <meta name="theme-color" content="#202124" media="(prefers-color-scheme: dark)">

  <!-- 파비콘 -->
  <link rel="icon" href="data:image/svg+xml,<svg…/></svg>">

  <!-- Pretendard 폰트 -->
  <link rel="stylesheet" as="style" crossorigin
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />

  <!-- main stylesheet -->
  <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">

  <!-- SEO 플러그인 -->
  {% seo %}
</head>
<body>

  {% include header.html %}

  <main class="content-wrapper" aria-label="Content">
    {{ content }}
  </main>

  {% comment %}
    이전·다음 내비게이션 (카테고리별 우선, 없으면 전체 순서)
  {% endcomment %}
  {% if page.layout == 'post' %}
    {% comment %} primary_category 우선, 없으면 첫 번째 categories 사용 {% endcomment %}
    {% assign category_to_navigate = page.primary_category | default: page.categories | first %}

    {% if category_to_navigate %}
      {% assign posts_in_category = site.categories[category_to_navigate] | default: [] | sort: 'date' %}
    {% endif %}

    {% if posts_in_category and posts_in_category.size > 1 %}
      {% comment %} 카테고리 내에서 현재 포스트 인덱스 찾기 {% endcomment %}
      {% assign idx = posts_in_category | map: 'url' | index_of: page.url %}
      {% if idx == -1 %}
        {% assign idx = posts_in_category | index_of: page %}
      {% endif %}

      {% if idx >= 0 %}
        {% assign last_index = posts_in_category.size | minus: 1 %}
        <hr>
        <nav class="post-nav" aria-label="이전·다음 글">
          {% if idx > 0 %}
            {% assign prev_post = posts_in_category[idx | minus: 1] %}
            <a class="prev" href="{{ prev_post.url | relative_url }}">
              « 이전 글: {{ prev_post.title }}
            </a>
          {% endif %}
          {% if idx < last_index %}
            {% assign next_post = posts_in_category[idx | plus: 1] %}
            <a class="next" href="{{ next_post.url | relative_url }}">
              다음 글: {{ next_post.title }} »
            </a>
          {% endif %}
        </nav>
      {% endif %}

    {% elsif page.previous or page.next %}
      {% comment %} 카테고리별 불가 시 전체 순서 내비게이션 {% endcomment %}
      <hr>
      <nav class="post-nav" aria-label="이전·다음 글">
        {% if page.previous %}
          <a class="prev" href="{{ page.previous.url | relative_url }}">
            « 이전 글: {{ page.previous.title }}
          </a>
        {% endif %}
        {% if page.next %}
          <a class="next" href="{{ page.next.url | relative_url }}">
            다음 글: {{ page.next.title }} »
          </a>
        {% endif %}
      </nav>
    {% endif %}
  {% endif %}

  {% include footer.html %}

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      /* copy-button, dark-mode 스크립트 */
      /* … 이전에 쓰시던 스크립트를 그대로 여기에 붙여넣으시면 됩니다 … */
    });
  </script>
</body>
</html>
